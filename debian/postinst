#!/bin/sh
set -e

case "$1" in
    configure)
        # remove previous mo files
        rm -f /usr/share/locale/*/LC_MESSAGES/RabbitVCS.mo >/dev/null 2>&1 || true

        [ -d "/opt/rabbitvcs-0.19" ] && cd /opt/rabbitvcs-0.19
        
        sudo python3 setup.py install --install-layout=deb \
        --record installfiles.txt >/dev/null 2>&1
        
        sudo chmod +x /usr/share/nemo-python/extensions/RabbitVCS.py
        
        killall nemo >/dev/null 2>&1 || true
    ;;

    abort-upgrade|abort-remove|abort-deconfigure)

    ;;

    *)
        echo "postinst called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac
